<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–∞–Ω–µ–ª—å –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞ - –ê–≤–∞—Ä–∏–π–Ω–∞—è —Å–ª—É–∂–±–∞ –í–æ–¥–æ–∫–∞–Ω–∞–ª–∞</title>
    <link rel="stylesheet" href="./css/style.css">
</head>
<body>
    <div class="page">
        <nav class="navbar">
            <div class="container nav-container">
                <div class="logo">
                    <img src="./images/logot.png" alt=""> <P>–ú–£–ü ¬´–í–æ–¥–æ–∫–∞–Ω–∞–ª¬ª –°–µ—Ä–≥–∏–µ–≤ –ü–æ—Å–∞–¥</P>
                </div>
                <div class="nav-links">
                    <a href="dispatcher-dashboard.html">–î–∞—à–±–æ—Ä–¥</a>
                    <a href="brigade-management.html">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—Ä–∏–≥–∞–¥–∞–º–∏</a>
                    <a href="chat.html">üí¨ –ß–∞—Ç —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</a>
                    <a href="reports.html">–û—Ç—á–µ—Ç—ã</a>
                    <a href="#" onclick="logout()">–í—ã–π—Ç–∏</a>
                </div>
                <div class="burger-menu" onclick="toggleMobileMenu()">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
            <div class="mobile-menu">
                <a href="dispatcher-dashboard.html">–î–∞—à–±–æ—Ä–¥</a>
                <a href="brigade-management.html">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—Ä–∏–≥–∞–¥–∞–º–∏</a>
                <a href="chat.html">üí¨ –ß–∞—Ç —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</a>
                <a href="reports.html">–û—Ç—á–µ—Ç—ã</a>
                <a href="#" onclick="logout()">–í—ã–π—Ç–∏</a>
            </div>
        </nav>
        
        <div class="dashboard container">
            <h1>–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞</h1>
            
            <div class="dashboard-grid">
                <div class="widget">
                    <h3>–í—Ö–æ–¥—è—â–∏–µ –∑–∞—è–≤–∫–∏</h3>
                    <div id="incoming-applications">
                    </div>
                </div>
                
                <div class="widget">
                    <h3>–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞—è–≤–∫–∏</h3>
                    <div id="critical-applications">
                    </div>
                </div>
                
                <div class="widget">
                    <h3>–°—Ç–∞—Ç—É—Å—ã –±—Ä–∏–≥–∞–¥</h3>
                    <div id="brigade-statuses">
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3>–í—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞—è–≤–∫–∏</h3>
                <div id="all-applications">
                </div>
            </div>
        </div>
    </div>

    <div id="application-detail-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeApplicationDetail()">&times;</span>
            <h2>–î–µ—Ç–∞–ª–∏ –∑–∞—è–≤–∫–∏ ‚Ññ<span id="detail-application-id"></span></h2>
            
            <div class="progress-container">
                <div class="progress-bar" id="application-progress-bar" style="width: 0%">0%</div>
            </div>

            <div class="progress-steps">
                <div class="progress-step">
                    <div class="step-circle" id="step-1-circle">1</div>
                    <div class="step-label">–ü–æ–¥–∞–Ω–∞</div>
                </div>
                <div class="progress-step">
                    <div class="step-circle" id="step-2-circle">2</div>
                    <div class="step-label">–ù–∞–∑–Ω–∞—á–µ–Ω–∞</div>
                </div>
                <div class="progress-step">
                    <div class="step-circle" id="step-3-circle">3</div>
                    <div class="step-label">–í —Ä–∞–±–æ—Ç–µ</div>
                </div>
                <div class="progress-step">
                    <div class="step-circle" id="step-4-circle">4</div>
                    <div class="step-label">–í—ã–ø–æ–ª–Ω–µ–Ω–∞</div>
                </div>
            </div>

            <div class="application-details">
                <div class="detail-section">
                    <h4>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                    <p><strong>–¢–∏–ø –∞–≤–∞—Ä–∏–∏:</strong> <span id="detail-type"></span></p>
                    <p><strong>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:</strong> <span id="detail-priority"></span></p>
                    <p><strong>–°—Ç–∞—Ç—É—Å:</strong> <span id="detail-status"></span></p>
                    <p><strong>–î–∞—Ç–∞ –ø–æ–¥–∞—á–∏:</strong> <span id="detail-created"></span></p>
                </div>

                <div class="detail-section">
                    <h4>–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h4>
                    <p><strong>–§–ò–û:</strong> <span id="detail-fio"></span></p>
                    <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> <span id="detail-phone"></span></p>
                    <p><strong>Email:</strong> <span id="detail-email"></span></p>
                </div>

                <div class="detail-section" style="grid-column: 1 / -1;">
                    <h4>–ê–¥—Ä–µ—Å –∏ –æ–ø–∏—Å–∞–Ω–∏–µ</h4>
                    <p><strong>–ê–¥—Ä–µ—Å:</strong> <span id="detail-address"></span></p>
                    <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:</strong></p>
                    <p id="detail-description"></p>
                </div>

                <div class="detail-section" style="grid-column: 1 / -1;">
                    <h4>–ù–∞–∑–Ω–∞—á–µ–Ω–Ω–∞—è –±—Ä–∏–≥–∞–¥–∞</h4>
                    <p id="detail-brigade">–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∞</p>
                    <p id="detail-brigade-contacts"></p>
                </div>
            </div>

            <div class="detail-section" style="grid-column: 1 / -1;">
                <h4>–ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏</h4>
                <div id="detail-photos" class="photo-gallery">
                </div>
            </div>

            <div class="detail-section" style="grid-column: 1 / -1;">
                <h4>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ</h4>
                <div class="map-container">
                    <div id="application-map"></div>
                </div>
            </div>

            <div class="detail-section" style="grid-column: 1 / -1;">
                <h4>–ß–∞—Ç —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º</h4>
                <div class="chat-container" style="height: 300px;">
                    <div class="chat-messages" id="application-chat-messages">
                    </div>
                    <div class="chat-input">
                        <input type="text" id="application-message-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
                        <button class="btn" onclick="sendApplicationMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                    </div>
                </div>
            </div>

            <div class="timeline">
                <h4>–ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤</h4>
                <div id="detail-timeline">
                </div>
            </div>

            <div class="application-actions">
                <button class="btn btn-warning" onclick="updateApplicationStatus()">‚úèÔ∏è –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å</button>
                <button class="btn btn-danger" onclick="closeApplicationDetail()">‚ùå –ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <script src="./js/utils.js"></script>
    <script src="./js/dispatcher.js"></script>
    <script src="./js/main.js"></script>
    <script src="./js/maps.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            loadDispatcherData();
        });
    </script>
</body>
</html>